/* client/src/components/styles/Guestbook.css */

/* Root vars paper theme & poetic highlights */
:root {
  --paper-bg: #fbf0e3;
  --paper-bg-rgb: 251, 240, 227;
  --paper-border: #d0c0aa;
  --paper-border-rgb: 208, 192, 170;
  --paper-text-color: #533d29;
  --paper-text-rgb: 83, 61, 41;
  --book-spine-color: #8c745c; /* Ít dùng trực tiếp, nhưng giữ để tham khảo */
  --book-cover-edge-curve: 35px; /* Tương tự, cho ý tưởng */

  /* Sử dụng các biến màu từ theme chung nếu có, hoặc định nghĩa ở đây */
  --guestbook-highlight: var(--highlight-color-poetic, #D8BFD8);
  --guestbook-highlight-rgb: var(--highlight-color-poetic-rgb, 216, 191, 216);
  --guestbook-primary-action: var(--primary-color, #ffaaaa);
  --guestbook-primary-action-rgb: var(--primary-color-rgb, 255, 170, 170);
  --guestbook-secondary-action: var(--secondary-color, #f5c2e7);
  --guestbook-secondary-action-rgb: var(--secondary-color-rgb, 245, 194, 231);

  /* Màu văn bản chung của guestbook, có thể lấy từ theme poetic */
  --guestbook-text: var(--text-color-poetic, #e6e6e6);
  --guestbook-text-rgb: var(--text-color-poetic-rgb, 230, 230, 230);
  --guestbook-subtext: var(--subtext-color-poetic, #c0c0c0);
  --guestbook-subtext-rgb: var(--subtext-color-poetic-rgb, 192,192,192);

  /* Màu nền cho các card trong guestbook, có thể là màu tối hơn paper-bg một chút */
  --guestbook-card-bg: rgba(var(--card-background-rgb, 30, 30, 46), 0.9); /* Dùng lại màu card từ App.css */
  --guestbook-card-bg-lighter: rgba(var(--card-background-rgb, 30, 30, 46), 0.75);

  --guestbook-scrollbar-thumb: rgba(var(--guestbook-highlight-rgb), 0.45);
  --guestbook-scrollbar-track: rgba(var(--paper-bg-rgb), 0.1); /* Nhạt hơn để hợp với paper-bg */
}

/* Guestbook Container (div.book-core) Styling - "Khung" của cuốn sổ */
.book-core {
  width: 165%; /* Rộng hơn một chút để vừa vặn hơn */
  max-width: 980px; /* Tăng max-width */
  height: 70vh; /* Chiều cao tương đối với viewport, điều chỉnh nếu cần */
  max-height: 750px; /* Giới hạn chiều cao tối đa */
  min-height: 450px; /* Đảm bảo đủ không gian */
  display: flex;
  flex-direction: column;
  background-color: transparent; 
  border-radius: 18px; /* Bo góc ngoài của "bìa sổ" */
  box-shadow: 0 18px 55px rgba(var(--background-color-rgb, 12, 14, 26), 0.45),
              0 8px 22px rgba(var(--background-color-rgb, 12, 14, 26), 0.3),
              inset 0 0 15px rgba(var(--paper-bg-rgb), 0.05);
  overflow: hidden; 
  position: relative;
  padding: 2px; /* Padding nhỏ cho "bìa" */
  /* Tạo hiệu ứng bìa sách với gradient và border */
  border: 3px solid var(--book-spine-color);
  background: linear-gradient(145deg, 
    rgba(var(--paper-bg-rgb),0.05), /* Màu nền trong suốt rất nhẹ cho "bìa" */
    rgba(var(--book-spine-color),0.08)
  );
}

/* Tiêu đề của Guestbook */
.guestbook-title {
  font-size: clamp(1.9em, 4.5vw, 2.4em); 
  font-weight: 400; 
  text-align: center;
  margin: clamp(1.5rem, 3vh, 2rem) auto clamp(1.2rem, 2.5vh, 1.8rem) auto;
  color: var(--guestbook-highlight);
  text-shadow: 0 0 25px rgba(var(--guestbook-highlight-rgb), 0.5),
               0 0 10px rgba(var(--guestbook-highlight-rgb), 0.35),
               0 2.5px 4px rgba(var(--background-color-rgb, 12,14,26), 0.25);
  letter-spacing: 2px; 
  line-height: 1.35;
  padding: 0 1rem; 
  position: relative; 
  z-index: 1;
  flex-shrink: 0; /* Ngăn title bị co lại */
}

/* Wrapper cho 2 trang sách */
.book-pages-wrapper {
  display: flex;
  flex-grow: 1; 
  width: 100%; 
  height: calc(100% - 70px); /* Điều chỉnh nếu title cao/thấp hơn */
  gap: 0; 
  perspective: 2500px; 
  padding: 0 3px; /* Khoảng hở nhỏ hơn, đủ thấy "gáy" */
  position: relative;
  z-index: 1;
}

/* Gáy sách giữa */
.book-pages-wrapper::before {
    content: '';
    position: absolute;
    top: -8px; /* Hơi chờm ra ngoài mép giấy một chút */
    bottom: -8px;
    left: 50%;
    transform: translateX(-50%);
    width: 25px; 
    background: 
      linear-gradient(to right, 
        rgba(0,0,0,0.22) 0%, /* Shadow tối hơn ở mép gáy */
        rgba(0,0,0,0.04) 30%,
        rgba(0,0,0,0.015) 50%,
        rgba(0,0,0,0.04) 70%,
        rgba(0,0,0,0.22) 100%
      );
    border-left: 1.8px solid rgba(0,0,0,0.1); 
    border-right: 1.8px solid rgba(0,0,0,0.1);
    z-index: 2; 
    pointer-events: none;
    border-radius: 4px; 
    box-shadow: 0 0 8px rgba(0,0,0,0.08) inset; 
}

/* Style chung cho mỗi trang sách */
.book-page {
  flex: 1; 
  background-color: var(--paper-bg);
  color: var(--paper-text-color);
  padding: 0; 
  box-sizing: border-box;
  overflow: hidden; 
  position: relative;
  display: flex; 
  flex-direction: column;
}
.book-page.page-left {
  border-top-left-radius: 10px; 
  border-bottom-left-radius: 10px;
  padding-right: 6px; /* Khoảng trống rộng hơn chút cho hiệu ứng trang */
  box-shadow: -4px 0 12px rgba(0,0,0,0.15) inset; 
}
.book-page.page-right {
  border-top-right-radius: 10px;
  border-bottom-right-radius: 10px;
  padding-left: 6px;
  box-shadow: 4px 0 12px rgba(0,0,0,0.15) inset;
}

/* Khu vực nội dung có thể cuộn của mỗi trang */
.page-content-scrollable {
  flex-grow: 1; 
  overflow-y: auto;
  padding: clamp(1rem, 2.5vw, 1.8rem) clamp(1.2rem, 3vw, 2rem); 
  scrollbar-width: thin;
  scrollbar-color: var(--guestbook-scrollbar-thumb) var(--guestbook-scrollbar-track);
}
.page-content-scrollable::-webkit-scrollbar { width: 9px; }
.page-content-scrollable::-webkit-scrollbar-track { background: var(--guestbook-scrollbar-track); border-radius: 8px; margin: 4px 0; }
.page-content-scrollable::-webkit-scrollbar-thumb {
  background-color: var(--guestbook-scrollbar-thumb);
  border-radius: 8px;
  border: 2.5px solid var(--paper-bg); /* Màu nền của trang cho border thumb */
  background-clip: padding-box; /* Cho border hiển thị đúng */
}
.page-content-scrollable::-webkit-scrollbar-thumb:hover {
  background-color: rgba(var(--guestbook-highlight-rgb), 0.6);
}

/* Prompt để viết lời nhắn */
.guestbook-write-prompt {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: clamp(1.2rem, 2.5vh, 1.5rem);
  padding: clamp(1.5rem, 3vh, 2rem) clamp(1rem, 2.5vw, 1.5rem);
  text-align: center;
  border-radius: 18px; 
  background-color: rgba(var(--paper-bg-rgb), 0.6); 
  border: 1.5px dashed rgba(var(--paper-border-rgb), 0.7);
  min-height: 220px; 
  color: var(--paper-text-color);
  font-family: var(--font-family-primary), cursive; /* Font poetic cho prompt */
}
.guestbook-write-prompt p {
  font-size: clamp(1em, 2.2vw, 1.15em);
  color: var(--paper-text-color);
  opacity: 0.9; 
  font-weight: 300; 
  margin: 0;
  max-width: 95%;
  line-height: 1.7;
}
.guestbook-write-prompt p strong { 
  font-weight: 500;
  color: var(--guestbook-primary-action);
  text-shadow: 0 0 5px rgba(var(--guestbook-primary-action-rgb), 0.3);
}


/* Nút bấm "Poetic" chung */
.poetic-button, .poetic-button-subtle, .poetic-button-primary {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 0.8em; 
  padding: 0.8rem 1.8rem; 
  border-radius: 30px; 
  font-family: inherit;
  font-size: clamp(0.95em, 2vw, 1.05em); 
  font-weight: 500;
  cursor: pointer;
  transition: transform 0.2s cubic-bezier(0.23, 1, 0.32, 1), 
              box-shadow 0.25s cubic-bezier(0.23, 1, 0.32, 1),
              filter 0.25s cubic-bezier(0.23, 1, 0.32, 1),
              background-color 0.25s ease, border-color 0.25s ease, color 0.25s ease;
  text-shadow: 0 1px 2px rgba(var(--paper-bg-rgb), 0.3); 
  position: relative;
  overflow: hidden; 
}
.poetic-button svg, .poetic-button-subtle svg, .poetic-button-primary svg {
  transition: transform 0.35s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
  stroke-width: 1.9; /* Hơi mảnh hơn mặc định */
}
.poetic-button:hover:not(:disabled) svg,
.poetic-button-subtle:hover:not(:disabled) svg,
.poetic-button-primary:hover:not(:disabled) svg {
  transform: rotate(7deg) scale(1.1); 
}


/* Nút "Để lại lời nhắn" */
.guestbook-write-button.poetic-button {
  border: 2px solid transparent;
  border-image-slice: 1;
  border-image-source: linear-gradient(140deg,
    rgba(var(--paper-text-rgb), 0.7), 
    rgba(var(--guestbook-primary-action-rgb), 0.5) 
  );
  background: linear-gradient(140deg, 
    rgba(var(--guestbook-primary-action-rgb), 0.15),
    rgba(var(--guestbook-secondary-action-rgb), 0.12)
  );
  color: var(--guestbook-primary-action);
  box-shadow: 0 6px 22px -6px rgba(var(--guestbook-primary-action-rgb),0.28);
}
.guestbook-write-button.poetic-button:hover:not(:disabled) {
  filter: brightness(1.15); 
  box-shadow: 0 9px 28px -6px rgba(var(--guestbook-highlight-rgb),0.38), 
              0 0 18px rgba(var(--guestbook-highlight-rgb),0.22) inset; 
}
.guestbook-write-button.poetic-button:hover:not(:disabled) .IconFeatherPen svg, /* Target icon SVG specific class if exists */
.guestbook-write-button.poetic-button:hover:not(:disabled) svg { /* Hoặc target SVG chung */
  animation: featherPulse 1.5s infinite ease-in-out; 
}
@keyframes featherPulse { 
  0%, 100% { transform: scale(1) rotate(7deg); filter: drop-shadow(0 0 3px rgba(var(--guestbook-highlight-rgb), 0.3)); }
  50% { transform: scale(1.15) rotate(5deg); filter: drop-shadow(0 0 7px rgba(var(--guestbook-highlight-rgb), 0.5)); }
}

/* Form nhập liệu */
.guestbook-form {
  display: flex;
  flex-direction: column;
  gap: clamp(1.3rem, 2.5vh, 1.6rem);
  padding: clamp(1.2rem, 2.5vw, 1.8rem) clamp(1rem, 2.5vw, 1.5rem);
  background-color: rgba(var(--paper-bg-rgb), 0.55); 
  border-radius: 18px;
  border: 1.5px solid rgba(var(--paper-border-rgb), 0.6);
  box-shadow: 0 6px 18px rgba(var(--paper-text-rgb),0.08), 
              inset 0 0 10px rgba(var(--paper-text-rgb),0.05);
  color: var(--paper-text-color);
}
.guestbook-form-title {
    font-size: clamp(1.15em, 2.5vw, 1.35em);
    font-weight: 500;
    color: var(--paper-text-color);
    opacity: 0.9;
    margin: 0 0 0.9rem 0; 
    text-align: left; 
    padding-bottom: 0.65rem;
    border-bottom: 1.5px solid rgba(var(--paper-border-rgb),0.6); 
}

.form-group { display: flex; flex-direction: column; gap: 0.65rem; text-align: left;}
.form-group label {
  font-size: clamp(0.85em, 1.8vw, 0.95em);
  font-weight: 400; 
  color: rgba(var(--paper-text-rgb), 0.9);
  padding-left: 0.3rem; 
  letter-spacing: 0.25px;
}

.form-group input[type="text"],
.form-group textarea {
  padding: 0.95rem 1.15rem; 
  border-radius: 12px; 
  border: 2.5px solid rgba(var(--paper-border-rgb), 0.8); 
  background-color: rgba(var(--paper-bg-rgb), 0.9); 
  color: var(--paper-text-color);
  font-family: var(--font-family-primary), cursive; 
  font-size: 0.95em; 
  transition: border-color 0.3s ease, box-shadow 0.3s ease, transform 0.2s ease, background-color 0.3s ease;
  outline: none;
  line-height: 1.5;
}
.form-group input[type="text"]::placeholder,
.form-group textarea::placeholder {
  color: rgba(var(--paper-text-rgb), 0.6); 
  font-style: italic;
  font-weight: 300;
}
.form-group textarea { resize: vertical; min-height: 100px; }


.form-feedback-container {
    min-height: 2.6em; 
    display: flex;
    flex-direction: column;
    justify-content: center;
    margin-top: -0.55rem; 
}
.submit-feedback {
  font-size: clamp(0.85em, 1.8vw, 0.95em);
  padding: 0.75rem 1.15rem;
  border-radius: 10px; 
  text-align: center;
  font-weight: 500; 
  border-width: 2px; 
  border-style: solid;
  letter-spacing: 0.2px;
}
.submit-feedback.error {
  background-color: rgba(var(--error-color-rgb), 0.15);
  color: var(--error-color);
  border-color: rgba(var(--error-color-rgb), 0.4);
  text-shadow: 0 0 7px rgba(var(--error-color-rgb), 0.22); 
}
.submit-feedback.success {
  background-color: rgba(var(--success-color-rgb, 166, 227, 161), 0.2); 
  color: var(--success-color, #a6e3a1);
  border-color: rgba(var(--success-color-rgb, 166, 227, 161), 0.45);
  text-shadow: 0 0 7px rgba(var(--success-color-rgb, 166, 227, 161), 0.28);
}

.form-actions {
    display: flex;
    gap: 1.1rem;
    margin-top: 0.9rem; 
    justify-content: flex-start; 
}

.guestbook-submit-button.poetic-button-primary {
  padding: 0.85rem 1.7rem; 
  background: linear-gradient(145deg, var(--guestbook-primary-action) 0%, var(--guestbook-highlight) 100%);
  color: var(--paper-bg); 
  font-weight: 500;
  border: none; 
  box-shadow: 0 5px 18px -4px rgba(var(--guestbook-primary-action-rgb),0.35), 
              0 3px 8px rgba(var(--guestbook-highlight-rgb),0.25),
              inset 0 -2px 3px rgba(0,0,0,0.1); 
  flex-grow: 1; 
  min-width: 140px; 
}
.guestbook-submit-button.poetic-button-primary:disabled {
    opacity: 0.65; 
    cursor: not-allowed;
    filter: saturate(0.5) brightness(0.9); 
}
.button-spinner {
  width: 1.25em;
  height: 1.25em;
  border: 3px solid rgba(var(--paper-bg-rgb), 0.7); 
  border-top-color: var(--paper-bg); 
  animation: buttonSpin 0.9s linear infinite;
  border-radius: 50%;
}
@keyframes buttonSpin { to { transform: rotate(360deg); } }

.guestbook-cancel-button.poetic-button-subtle {
  border: 2px solid rgba(var(--paper-text-rgb), 0.4); 
  background-color: transparent; 
  color: var(--paper-text-color); 
  font-size: clamp(0.9em, 1.9vw, 1em); 
  font-weight: 400;
  box-shadow: 0 2.5px 6px rgba(var(--paper-text-rgb),0.07); 
}
.guestbook-cancel-button.poetic-button-subtle:hover:not(:disabled) {
  background-color: rgba(var(--paper-text-rgb), 0.08); 
  border-color: rgba(var(--paper-text-rgb), 0.6);
  color: var(--paper-text-color);
}
.guestbook-cancel-button.poetic-button-subtle:disabled {
    opacity: 0.55;
    cursor: not-allowed;
}

.guestbook-entries-list-wrapper {
    display: flex;
    flex-direction: column;
    gap: clamp(1.5rem, 3vh, 1.8rem); 
}

.guestbook-entry {
  background-color: var(--paper-bg); 
  padding: clamp(1.3rem, 3vw, 1.7rem) clamp(1.5rem, 3.5vw, 1.9rem); 
  border-radius: 14px; 
  border: 1.5px solid var(--paper-border); 
  box-shadow: 4px 4px 12px rgba(var(--paper-text-rgb), 0.12), 
              2px 2px 5px rgba(var(--paper-text-rgb), 0.08),
              inset 0 0 10px rgba(255,255,255,0.25); 
  text-align: left;
  overflow-wrap: break-word; 
  position: relative; 
  color: var(--paper-text-color);
}
.guestbook-entry::after {
  content: "";
  position: absolute;
  top: -1.5px; 
  right: -1.5px;
  width: 38px; 
  height: 38px;
  background: linear-gradient(135deg,
    transparent 48%, 
    rgba(var(--paper-border-rgb), 0.5) 48.5%, 
    rgba(var(--paper-border-rgb), 0.35) 55%, 
    var(--paper-bg) 68% 
  );
  border-bottom-left-radius: 10px; 
  filter: drop-shadow(-1.5px 1.5px 1.5px rgba(0,0,0,0.1)); 
  pointer-events: none; 
}

.entry-message-wrapper {
    margin: 0 0 1.1rem 0; 
    padding: 0;
    border: none; 
    position: relative; 
}
.entry-message-wrapper::before {
  content: '“';
  font-family: 'Georgia', 'Times New Roman', serif; 
  font-size: 3em; 
  color: rgba(var(--paper-text-rgb), 0.3); 
  position: absolute;
  left: -0.15em; 
  top: -0.4em;  
  line-height: 0.8;
  opacity: 0.9;
  pointer-events: none;
  font-style: italic; 
}

.entry-message {
  font-family: var(--font-family-primary), 'cursive'; 
  font-size: clamp(1em, 2.2vw, 1.15em);
  line-height: 1.75; 
  color: var(--paper-text-color);
  margin: 0;
  padding-left: 0.9em; 
  white-space: pre-wrap; 
  font-style: normal; 
  font-weight: 400; 
}
.entry-meta {
  font-size: clamp(0.8em, 1.8vw, 0.9em); 
  color: rgba(var(--paper-text-rgb), 0.8);
  display: flex;
  flex-direction: row; 
  justify-content: space-between; 
  align-items: center;
  flex-wrap: wrap; 
  gap: 0.5rem;
  opacity: 0.9;
  padding-top: 0.9rem;
  border-top: 1.5px dashed rgba(var(--paper-border-rgb), 0.7); 
  margin-top: 0.65rem; 
}
.entry-author strong { 
  font-weight: 500;
  color: var(--paper-text-color); 
  letter-spacing: 0.4px;
}
.entry-timestamp { font-style: italic; } 

.no-entries-message {
  text-align: center;
  font-style: italic;
  color: var(--paper-text-color);
  opacity: 0.85;
  padding: clamp(2.5rem, 6vh, 3rem) clamp(1.5rem, 4vw, 2rem);
  font-size: clamp(1em, 2.1vw, 1.15em);
  border: 2px dashed rgba(var(--paper-border-rgb), 0.6);
  border-radius: 14px;
  background-color: rgba(var(--paper-bg-rgb),0.5);
  line-height: 1.7;
  min-height: 150px;
  display: flex;
  align-items: center;
  justify-content: center;
}

@media (max-width: 1024px) { /* Tăng điểm breakpoint cho tablet lớn */
  .book-core { 
    width: 95%; 
    height: auto; /* Chiều cao tự động hơn */
    max-height: 85vh; 
    min-height: 400px;
  }
  .guestbook-title { margin-bottom: clamp(1rem, 2vh, 1.2rem); }
}

@media (max-width: 768px) {
  .book-core { max-height: calc(88vh - 70px); padding: 1px;}
  .book-core::before, .book-core::after { display: none; } /* Bỏ mép sách giả */

  .guestbook-title { margin: clamp(1.2rem, 2.5vh, 1.8rem) auto clamp(1rem, 2vh, 1.5rem) auto; }
  .page-content-scrollable { padding: clamp(0.8rem, 2vw, 1.5rem) clamp(1rem, 2.5vw, 1.8rem); }

  .form-actions {
    flex-direction: column-reverse; 
    gap: 0.9rem;
  }
  .form-actions > button { width: 100%; } 
}

@media (max-width: 640px) { /* Breakpoint cho mobile nhỏ hơn */
    .book-core {
        width: 98%; /* Chiếm gần hết */
        max-height: calc(90vh - 40px); /* Thêm chút không gian nếu keyboard hiện */
        border-radius: 12px; /* Giảm bo góc bìa */
        padding: 1.5px;
        border-width: 2px;
    }
    .book-pages-wrapper {
        flex-direction: column; 
        height: auto; 
        padding: 0; 
        perspective: none; 
    }
    .book-pages-wrapper::before { display: none; }

    .book-page {
        flex-basis: auto; 
        min-height: 320px; /* Tăng nhẹ min-height */
        max-height: 48vh; 
    }
    .book-page.page-left {
        border-radius: 10px; 
        margin-bottom: 0.8rem; 
        box-shadow: 0 3px 10px rgba(0,0,0,0.12); 
        padding-right: 0; 
    }
    .book-page.page-right {
        border-radius: 10px;
        box-shadow: 0 3px 10px rgba(0,0,0,0.12);
        padding-left: 0;
    }
    .page-content-scrollable {
        --guestbook-scrollbar-track: rgba(var(--paper-bg-rgb), 0.6);
    }

    .guestbook-form-title { border-bottom: none; text-align: center; margin-bottom: 0.7rem; }
    .entry-meta { flex-direction: column; align-items: flex-start; gap: 0.3rem; }
    .guestbook-entry::after { width: 32px; height: 32px; } 
    .entry-message-wrapper::before { font-size: 2.7em; } 
}

@media (max-width: 480px) {
  .book-page { min-height: 280px; max-height: 50vh; } 
  .poetic-button, .poetic-button-subtle, .poetic-button-primary {
     padding: 0.7rem 1.5rem; 
     font-size: clamp(0.9em, 1.9vw, 1em); 
  }
  .form-group textarea { min-height: 80px; }
  .guestbook-entry { padding: clamp(1rem, 2.5vw, 1.5rem) clamp(1.2rem, 3vw, 1.6rem); }
  .entry-message-wrapper::before { font-size: 2.5em; top: -0.3em; }
}